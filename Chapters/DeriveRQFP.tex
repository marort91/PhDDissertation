\chapter{The Rayleigh Quotient Fixed Point Method}
\label{ch3}

In this chapter we derive the Rayleigh Quotient Fixed Point (RQFP) method for alpha- and $k$-effective eigenvalue problems. We begin with the matrix form of the eigenvalue equations and proceed to develop a fixed point method for the angular flux eigenvector. Since the eigenvector corresponds to the alpha- or $k$-effective eigenvalue, we require an update for the eigenvalue at each iteration. We derive an eigenvalue update that is optimal in the least squares sense by relating the alpha- or $k$-effective eigenvalue to the dominant eigenvalue of a primitive matrix (see Section~\ref{sec:LinAlg}). This primitive matrix serves as the fixed point function to determine the solution of the eigenvalue problem. Since the dominant eigenvalue of a primitive matrix corresponds to the only positive eigenvector of the matrix, this eigenvector also solves the discretized criticality eigenvalue neutron transport problem. We end this chapter with a discussion of the primitivity of the discretized alpha- and $k$-effective eigenvalue matrix equations.

\section{Derivation of the Rayleigh Quotient Fixed Point Method for Alpha-Eigenvalue Problems}

We begin with the discretized alpha-eigenvalue matrix equation:
\begin{equation}
	\big ( \alpha \mathbf{V}_{\mathbf{z}}^{-1} + \mathbf{H_{z}} \big ) \mathbf{\Psi_{z}} = \mathbf{L}^{+} \big ( \mathbf{\Sigma_{s}} + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \mathbf{\Psi_{z}}.
	\label{eq:AlphaMatrixRQ}
\end{equation}
Solution of Eq.~\ref{eq:AlphaMatrixRQ} consists of finding the eigenpair ($\alpha,\mathbf{\Psi}$) that satisfies the equation with $\alpha$ a real number and the vector $\mathbf{\Psi}$ positive. We write a fixed point equation for Eq.~\ref{eq:AlphaMatrixRQ} in the form
\begin{equation}
	\mathbf{\Psi_{z}} = \mathbf{H}^{-1}_{\mathbf{z}} \big ( -\alpha \mathbf{V}_{\mathbf{z}}^{-1} + \mathbf{L}^{+} \big ( \mathbf{\Sigma_{s}} + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \big ) \mathbf{\Psi} \equiv \mathbf{A}(\alpha) \mathbf{\Psi_{z}}.
	\label{eq:AlphaRQFP}
\end{equation}
For all subcritical and critical systems, the righthand side of Eq.~\ref{eq:AlphaRQFP} is nonnegative since for isotropic scattering the scattering matrix is nonnegative. For supercritical systems, there is an $\alpha_{\text{max}}$ such that the righthand side is still nonnegative. Various fixed point equations can be written for the angular flux eigenvector $\mathbf{\Psi_{z}}$. However, this form was selected as it only requires the inversion of the matrix $\mathbf{H_{z}}$. In standard neutron transport codes \cite{hanebutte_ardra_1999} \cite{alcouffe2005partisn}, the matrix $\mathbf{H_{z}}$ is inverted without being formed by sweeping across the domain in space and angle. The updated eigenvector iterate is obtained by the action of the inverted operator on the source. By writing the fixed point in this way, the Rayleigh quotient fixed point method can be implemented easily in production neutron transport codes.

We define an iterative method to find the fixed point (see Section~\ref{}) of Eq.~\ref{eq:AlphaRQFP} as
\begin{equation}
	\mathbf{\Psi_{z}}^{(i+1)} = \mathbf{A}(\alpha^{(i)}) \mathbf{\Psi_{z}}^{(i)}.
\end{equation}
From some initial positive starting vector $\mathbf{\Psi_{z}}^{(0)}$, the subsequent eigenvector iterate is determined by the action of inversion of the matrix $\mathbf{H_{z}}$ on the scattering and fission source adjusted by the alpha-eigenvalue. At each iteration, an update for the eigenvalue is required. A natural choice of update is that the eigenvalue be a function of the eigenvector iterate. Given an eigenpair, $(\alpha_{*}, \mathbf{\Psi_{z}^{*}})$ to Eq.~\ref{eq:AlphaMatrixRQ}, it follows that
\begin{equation}
	\mathbf{\Psi_{z}^{*}} =  \mathbf{A}(\alpha_{*}) \mathbf{\Psi_{z}^{*}}
\end{equation}
is also an eigenvalue problem for the fixed matrix $\mathbf{A}(\alpha_{*})$ with eigenvector $\mathbf{\Psi}_{\mathbf{z}}^{*}$ and eigenvalue one.

If the matrix $\mathbf{A}(\alpha)$ is a primitive matrix, it follows from the Perron-Froebenius Theorem for Primitive Matrices that there is only one unique positive eigenvector of $\mathbf{A}(\alpha)$ corresponding to the dominant eigenvalue. This fact allows us to derive an update for the alpha-eigenvalue at each iteration.

If $(\mathbf{\Psi_{z}^{*}}, \lambda)$ is an eigenpair of the matrix $\mathbf{A}(\alpha_{*})$, then
\begin{equation}
\norm{\mathbf{A}(\alpha_{*}) \mathbf{\Psi_{z}^{*}} - \lambda \mathbf{\Psi_{z}^{*}}}_{2}^{2} = 0.
\end{equation}
However, suppose $\mathbf{\Psi}_{(i)}$ is an approximate eigenvector and we seek to find the best approximate eigenvalue $\hat{\lambda}$ such that
\begin{equation}
\hat{\lambda} = \argmin_{\mu} \norm{\mathbf{A}\big (\alpha_{(i)} \big ) \mathbf{\Psi}_{(i)} - \mu \mathbf{\Psi}_{(i)}}_{2}^{2}. 
\end{equation}
This is a linear least squares problem in the variable $\mu$. It is found that \cite{horn_matrix_2012}
\begin{equation}
	\hat{\lambda} = \frac{\mathbf{\Psi}^{T}_{(i)} \mathbf{A}\big (\alpha_{(i)} \big ) \mathbf{\Psi}_{(i)}}{\mathbf{\Psi}^{T}_{(i)} \mathbf{\Psi}_{(i)}},
\end{equation}
the Rayleigh quotient, minimizes the residual in the least squares sense. Setting the Rayleigh quotient to one and solving for the approximate alpha-eigenvalue $\alpha_{(i)}$, we obtain the alpha-eigenvalue update for an approximate eigenvector $\mathbf{\Psi}_{(i)}$
\begin{equation}
	\alpha_{(i)} = \frac{ \mathbf{\Psi}^{T}_{(i)} \mathbf{H}^{-1}_{\mathbf{z}} \mathbf{L}^{+} \big ( \mathbf{\Sigma_{s}} + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \mathbf{\Psi}_{(i)} -  \mathbf{\Psi}^{T}_{(i)}  \mathbf{\Psi}_{(i)}}{  \mathbf{\Psi}^{T}_{(i)} \mathbf{H}^{-1}_{\mathbf{z}} \mathbf{V}^{-1}_{\mathbf{z}}  \mathbf{\Psi}_{(i)}}.
	\label{eq:AlphaUpdateTwoSweep}
\end{equation}

Given Eq.~\ref{eq:AlphaUpdateTwoSweep}, we introduce Algorithm \ref{algo:alpha}, an iterative scheme to determine the alpha-eigenvalue and its corresponding eigenvector. The eigenvalue update is optimal in the least squares sense. For alpha-eigenvalue problems, whereas traditional techniques have focused on supercritical problems and were limited in subcritical cases \cite{hill_efficient_1983}, this method allows for the solution of both subcritical and supercritical systems.
\begin{algorithm}[t]
	\caption{Rayleigh Quotient Fixed Point Method for the Alpha-Eigenvalue Problem}
	\label{algo:alpha}
	\begin{algorithmic}
		\WHILE{$\text{residual} > \text{tolerance}$}
		\STATE{ 
			\begin{equation*}
				\alpha_{(i)} = \frac{ \mathbf{\Psi}^{T}_{(i)} \mathbf{H}^{-1}_{\mathbf{z}} \mathbf{L}^{+} \big ( \mathbf{\Sigma_{s}} + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \mathbf{\Psi}_{(i)} -  \mathbf{\Psi}^{T}_{(i)}  \mathbf{\Psi}_{(i)}}{  \mathbf{\Psi}^{T}_{(i)} \mathbf{H}^{-1}_{\mathbf{z}} \mathbf{V}^{-1}_{\mathbf{z}}  \mathbf{\Psi}_{(i)}}
			\end{equation*}
		}
		\STATE{ 
			\begin{equation*}
				\mathbf{\Psi}_{(i+1)} = \mathbf{H}_{\mathbf{z}}^{-1} \bigg (-\alpha_{(i)} \mathbf{V}_{\mathbf{z}}^{-1} + \mathbf{L}^{+}  \big ( \mathbf{\Sigma_{s}}  + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \bigg )\mathbf{\Psi}_{(i)}
			\end{equation*}

		}
		\STATE{

			\begin{equation*}
				\text{residual} = \frac{\norm{\mathbf{\Psi}_{(i+1)} - \mathbf{\Psi}_{(i)}}_{2}}{\norm{\mathbf{\Psi}_{(i+1)}}_{2}}
			\end{equation*}
		}
		\ENDWHILE
	\end{algorithmic}
\end{algorithm}

For each iteration in Algorithm \ref{algo:alpha} two transport sweeps (inversions of $\mathbf{H_{z}}$) are required. To reduce the number of transport sweeps required, we note that Eq.~\ref{eq:AlphaUpdateTwoSweep} can be written as
\begin{equation}
	\alpha_{(i)} = \frac{ \mathbf{\Psi}^{T}_{(i)} \mathbf{L}^{+} \big ( \mathbf{\Sigma_{s}} + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \mathbf{\Psi}_{(i)} -  \mathbf{\Psi}^{T}_{(i)}  \mathbf{H_{z}} \mathbf{\Psi}_{(i)}}{  \mathbf{\Psi}^{T}_{(i)} \mathbf{V}^{-1}_{\mathbf{z}}  \mathbf{\Psi}_{(i)}}.
	\label{eq:AlphaUp}
\end{equation}
Using the fact that 
\begin{equation}
\mathbf{H_{z}} \mathbf{\Psi}_{(i)} =  \bigg ( -\alpha_{(i-1)} \mathbf{V}_{\mathbf{z}}^{-1} + \mathbf{L}^{+} \big ( \mathbf{\Sigma_{s}} + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \bigg ) \mathbf{\Psi}_{(i-1)} \equiv \mathbf{q}_{(i-1)},
\end{equation}
where $\mathbf{q}$ is the scattering and fission source vector, we can write Eq.~\ref{eq:AlphaUp} as
\begin{equation}
	\alpha_{(i)} = \frac{ \mathbf{\Psi}^{T}_{(i)} \mathbf{L}^{+} \big ( \mathbf{\Sigma_{s}} + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \mathbf{\Psi}_{(i)} -  \mathbf{\Psi}^{T}_{(i)}  \mathbf{q}_{(i-1)}}{  \mathbf{\Psi}^{T}_{(i)} \mathbf{V}^{-1}_{\mathbf{z}}  \mathbf{\Psi}_{(i)}}.
	\label{eq:AlphaUp}
\end{equation}
We introduce a one-sweep variant of Algorithm~\ref{algo:alpha} in Algorithm~\ref{algo:alpha_one}. For the first iteration ($i=0$), the source $\mathbf{q}_{(-1)} = \mathbf{0}$ where $\mathbf{0}$ is the zero vector. Algorithm~\ref{algo:alpha_one} requires only one transport sweep per iteration of the method. However, the method requires two vectors per iteration, one to store the angular flux vector and another to store the previous fission and scattering source vector.
\begin{algorithm}[ht]
	\caption{One-Sweep Rayleigh Quotient Fixed Point Method for the Alpha-Eigenvalue Problem}
	\label{algo:alpha_one}
	\begin{algorithmic}
		\WHILE{$\text{residual} > \text{tolerance}$}
		\IF{$i = 0$}
			\STATE{ 
			\begin{equation*}
	\alpha_{(i)} = \frac{ \mathbf{\Psi}^{T}_{(i)} \mathbf{L}^{+} \big ( \mathbf{\Sigma_{s}} + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \mathbf{\Psi}_{(i)}}{  \mathbf{\Psi}^{T}_{(i)} \mathbf{V}^{-1}_{\mathbf{z}}  \mathbf{\Psi}_{(i)}}.
	\label{eq:AlphaUp}
			\end{equation*}
}
		\STATE{
		\begin{equation*}
		\mathbf{q}_{(i)} =  \bigg (-\alpha_{(i)} \mathbf{V}_{\mathbf{z}}^{-1} + \mathbf{L}^{+}  \big ( \mathbf{\Sigma_{s}}  + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \bigg )\mathbf{\Psi}_{(i)}
		\end{equation*}
		}
		\STATE{
		\begin{equation*}
				\mathbf{\Psi}_{(i+1)} = \mathbf{H}_{\mathbf{z}}^{-1} \mathbf{q}_{(i)}
		\end{equation*}
		}
		\ELSE
		\STATE{ 
			\begin{equation*}
	\alpha_{(i)} = \frac{ \mathbf{\Psi}^{T}_{(i)} \mathbf{L}^{+} \big ( \mathbf{\Sigma_{s}} + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \mathbf{\Psi}_{(i)} -  \mathbf{\Psi}^{T}_{(i)}  \mathbf{q}_{(i-1)}}{  \mathbf{\Psi}^{T}_{(i)} \mathbf{V}^{-1}_{\mathbf{z}}  \mathbf{\Psi}_{(i)}}.
\end{equation*}
		}
\STATE{
		\begin{equation*}
		\mathbf{q}_{(i)} =  \bigg (-\alpha_{(i)} \mathbf{V}_{\mathbf{z}}^{-1} + \mathbf{L}^{+}  \big ( \mathbf{\Sigma_{s}}  + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \bigg )\mathbf{\Psi}_{(i)}
		\end{equation*}
		}
		\STATE{
		\begin{equation*}
				\mathbf{\Psi}_{(i+1)} = \mathbf{H}_{\mathbf{z}}^{-1} \mathbf{q}_{(i)}
		\end{equation*}
		}
		\ENDIF
				\STATE{

			\begin{equation*}
				\text{residual} = \frac{\norm{\mathbf{\Psi}_{(i+1)} - \mathbf{\Psi}_{(i)}}_{2}}{\norm{\mathbf{\Psi}_{(i+1)}}_{2}}
			\end{equation*}
		}
		\ENDWHILE
	\end{algorithmic}
\end{algorithm}

\section{Derivation of the Rayleigh Quotient Fixed Point Method for $k$-Effective Problems}

Derivation of the $k$-effective Rayleigh Quotient Fixed Point Method follows a similar procedure as the alpha-eigenvalue RQFP. We begin with the discretized $k$-effective eigenvalue matrix equation:
\begin{equation}
	\mathbf{H_{z}} \mathbf{\Psi_{z}} = \mathbf{L}^{+} \bigg ( \mathbf{\Sigma_{s}} + \frac{1}{k}\mathbf{\Sigma_{f}} \bigg ) \mathbf{L} \mathbf{\Psi_{z}},
	\label{eq:kZDerive}
\end{equation}
Once again, we search for the eigenpair $(k, \mathbf{\Psi})$ that satisfies Eq.~\ref{eq:kZDerive}. We write Eq.~\ref{eq:kZDerive} in the fixed point form
\begin{equation}
	\mathbf{\Psi_{z}} = \mathbf{H}^{-1}_{\mathbf{z}} \bigg [ \mathbf{L}^{+} \bigg ( \mathbf{\Sigma_{s}} + \frac{1}{k} \mathbf{\Sigma_{f}} \bigg ) \mathbf{L} \bigg ] \mathbf{\Psi} \equiv \mathbf{T}(k) \mathbf{\Psi_{z}}.
	\label{eq:kRQFP}
\end{equation}
For all systems, the righthand side of Eq.~\ref{eq:kRQFP} is nonnegative for isotropic scattering and $k$ is nonnegative \cite{warsa_krylov_2004}. The fixed point form is selected to only require the inversion of the matrix $\mathbf{H}_{\mathbf{z}}$.
We define an iterative method to find the fixed point of Eq.~\ref{eq:kRQFP} as
\begin{equation}
	\mathbf{\Psi_{z}}^{(i+1)} = \mathbf{T}(k^{(i)}) \mathbf{\Psi_{z}}^{(i)}.
	\label{eq:FPk}
\end{equation}
From some initial positive starting vector $\mathbf{\Psi_{z}}^{(0)}$, the subsequent eigenvector iterate is determined by the action of inversion of the matrix $\mathbf{H_{z}}$ on the scattering and fission source where the fission source is adjusted by the $k$-effective eigenvalue. At each iteration, an update for the eigenvalue is required. If $(k_{*},\mathbf{\Psi}_\mathbf{z}^{*})$ is an eigenpair of Eq.~\ref{eq:FPk}, it follows that
\begin{equation}
	\mathbf{\Psi_{z}}^{*} = \mathbf{T}(k_{*}) \mathbf{\Psi}_\mathbf{z}^{*}
\end{equation}
is also an eigenvalue problem with eigenpair $(\mathbf{1},\mathbf{\Psi}_\mathbf{z}^{*})$.

Similar to the alpha-eigenvalue matrix $\mathbf{A}(\alpha)$, if the matrix $\mathbf{T}(k)$ is a primitive matrix, it follows from the Perron-Froebenius Theorem for Primitive Matrices that there is only one unique positive eigenvector of $\mathbf{T}(k)$ corresponding to the dominant eigenvalue. This fact allows us to derive an update for the $k$-effective eigenvalue at each iteration.

Suppose $\mathbf{\Psi}_{(i)}$ is an approximate eigenvector and we seek to find the best approximate eigenvalue $\hat{\lambda}$ such that
\begin{equation}
\hat{\lambda} = \argmin_{\mu} \norm{\mathbf{T}\big (k_{(i)} \big ) \mathbf{\Psi}_{(i)} - \mu \mathbf{\Psi}_{(i)}}_{2}^{2}. 
\end{equation}
This is, once again, a linear least squares problem in the variable $\mu$. From before, it is found that the Rayleigh quotient given by
\begin{equation}
	\hat{\lambda} = \frac{\mathbf{\Psi}^{T}_{(i)} \mathbf{T}\big (k_{(i)} \big ) \mathbf{\Psi}_{(i)}}{\mathbf{\Psi}^{T}_{(i)}\mathbf{\Psi}_{(i)}},
\end{equation}
minimizes the residual in the least square sense. Setting the Rayleigh quotient to one and solving for the $k$-effective eigenvalue $k_{(i)}$, we obtain the $k$-effective eigenvalue update for eigenvector iterate $\mathbf{\Psi}_{(i)}$
\begin{equation}
	k_{(i)} = \frac{\mathbf{\Psi}^{T}_{(i)} \mathbf{H}_{\mathbf{z}}^{-1} \mathbf{L} \mathbf{\Sigma_{f}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}{\mathbf{\Psi}^{T}_{(i)}\mathbf{\Psi}_{(i)} - \mathbf{\Psi}^{T}_{(i)} \mathbf{H}_{\mathbf{z}}^{-1} \mathbf{L} \mathbf{\Sigma_{s}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}.
	\label{eq:TwoSweepkUpdate}
\end{equation}

Given Eq.~\ref{eq:TwoSweepkUpdate}, we introduce Algorithm~\ref{algo:kTwo}, an iterative scheme to determine the $k$-effective eigenvalue and its corresponding eigenvector. The eigenvalue update is optimal in the least squares sense.

\begin{algorithm}[t]
	\caption{Rayleigh Quotient Fixed Point Method for the $k$-Effective Eigenvalue Problem}
	\label{algo:kTwo}
	\begin{algorithmic}
		\WHILE{$\text{residual} > \text{tolerance}$}
		\STATE{ 
			\begin{equation*}
				k_{(i)} = \frac{\mathbf{\Psi}^{T}_{(i)} \mathbf{H}_{\mathbf{z}}^{-1} \mathbf{L} \mathbf{\Sigma_{f}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}{\mathbf{\Psi}^{T}_{(i)}\mathbf{\Psi}_{(i)} - \mathbf{\Psi}^{T}_{(i)} \mathbf{H}_{\mathbf{z}}^{-1} \mathbf{L} \mathbf{\Sigma_{s}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}
			\end{equation*}
		}
		\STATE{ 
			\begin{equation*}
				\mathbf{\Psi}_{(i+1)} = \mathbf{H}_{\mathbf{z}}^{-1} \bigg [ \mathbf{L}^{+}  \bigg ( \mathbf{\Sigma_{s}}  + \frac{1}{k_{(i)}} \mathbf{\Sigma_{f}} \bigg ) \mathbf{L} \bigg ] \mathbf{\Psi}_{(i)}
			\end{equation*}
		}
		\STATE{

			\begin{equation*}
				\text{residual} = \frac{\norm{\mathbf{\Psi}_{(i+1)} - \mathbf{\Psi}_{(i)}}_{2}}{\norm{\mathbf{\Psi}_{(i+1)}}_{2}}
			\end{equation*}
		}
		\ENDWHILE
	\end{algorithmic}
\end{algorithm}

For each iteration of Algorithm~\ref{algo:kTwo}, two transport sweeps are required to determine the transported fission and scattering terms. To require only one transport sweep, we rewrite Eq.~\ref{eq:TwoSweepkUpdate} as
\begin{equation}
	k_{(i)} = \frac{\mathbf{\Psi}^{T}_{(i)} \mathbf{L} \mathbf{\Sigma_{f}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}{\mathbf{\Psi}^{T}_{(i)}\mathbf{H}_{\mathbf{z}} \mathbf{\Psi}_{(i)} - \mathbf{\Psi}^{T}_{(i)} \mathbf{L} \mathbf{\Sigma_{s}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}.
	\label{eq:HkUpdate}
\end{equation}
Using the fact that
\begin{equation}
\mathbf{H_{z}} \mathbf{\Psi}_{(i)} =  \bigg [ \mathbf{L}^{+} \bigg ( \mathbf{\Sigma_{s}} + \frac{1}{k}\mathbf{\Sigma_{f}} \bigg ) \mathbf{L} \bigg ] \mathbf{\Psi}_{(i-1)} \equiv \mathbf{q}_{(i-1)},
\end{equation}
we can write the update, Eq.~\ref{eq:HkUpdate} as
\begin{equation}
	k_{(i)} = \frac{\mathbf{\Psi}^{T}_{(i)} \mathbf{L} \mathbf{\Sigma_{f}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}{\mathbf{\Psi}^{T}_{(i)}\mathbf{q}_{(i-1)} - \mathbf{\Psi}^{T}_{(i)} \mathbf{L} \mathbf{\Sigma_{s}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}.
	\label{eq:HkUpdate}
\end{equation}
We introduce Algorithm~\ref{algo:kOne}, a one-sweep variant of Algorithm~\ref{algo:kTwo}. For the initial iteration, $k_{(0)} = 1$. Algorithm~\ref{algo:kOne} requires only one transport sweep per iteration of the method. However, it requires three vectors to store the angular flux and fission and scattering sources. For some angular flux iterates, it has been observed that the $k$-effective eigenvalue iterate can be negative for some iterations. However, in practice, this has not prevented convergence of the method to a positive eigenvalue.
\begin{algorithm}[t]
	\caption{One-Sweep Rayleigh Quotient Fixed Point Method for the $k$-Effective Eigenvalue Problem}
	\label{algo:kOne}
	\begin{algorithmic}
		\WHILE{$\text{residual} > \text{tolerance}$}
		\IF{$i = 0$}
		\STATE{
		\begin{equation*}
		\mathbf{q}_{(i)} =  \big [ \mathbf{L}^{+}  \big ( \mathbf{\Sigma_{s}}  + \mathbf{\Sigma_{f}} \big ) \mathbf{L} \big ]\mathbf{\Psi}_{(i)}
		\end{equation*}
		}
		\STATE{
		\begin{equation*}
				\mathbf{\Psi}_{(i+1)} = \mathbf{H}_{\mathbf{z}}^{-1} \mathbf{q}_{(i)}
		\end{equation*}
		}
		\ELSE
		\STATE{ 
			\begin{equation*}
	k_{(i)} = \frac{\mathbf{\Psi}^{T}_{(i)} \mathbf{L} \mathbf{\Sigma_{f}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}{\mathbf{\Psi}^{T}_{(i)}\mathbf{q}_{(i-1)} - \mathbf{\Psi}^{T}_{(i)} \mathbf{L} \mathbf{\Sigma_{s}} \mathbf{L}^{+} \mathbf{\Psi}_{(i)}}.
\end{equation*}
		}
\STATE{
		\begin{equation*}
		\mathbf{q}_{(i)} =  \bigg [ \mathbf{L}^{+}  \bigg ( \mathbf{\Sigma_{s}}  + \frac{1}{k_{(i)}}\mathbf{\Sigma_{f}} \bigg ) \mathbf{L} \bigg ]\mathbf{\Psi}_{(i)}
		\end{equation*}
		}
		\STATE{
		\begin{equation*}
				\mathbf{\Psi}_{(i+1)} = \mathbf{H}_{\mathbf{z}}^{-1} \mathbf{q}_{(i)}
		\end{equation*}
		}
		\ENDIF
				\STATE{

			\begin{equation*}
				\text{residual} = \frac{\norm{\mathbf{\Psi}_{(i+1)} - \mathbf{\Psi}_{(i)}}_{2}}{\norm{\mathbf{\Psi}_{(i+1)}}_{2}}
			\end{equation*}
		}
		\ENDWHILE
	\end{algorithmic}
\end{algorithm}

